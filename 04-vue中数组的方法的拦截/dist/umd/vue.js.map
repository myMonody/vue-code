{"version":3,"file":"vue.js","sources":["../../src/observer/array.js","../../src/observer/index.js","../../src/state.js","../../src/init.js","../../src/index.js"],"sourcesContent":["// 拿到数组原型上的方法---原来的方法\nlet oldArrayProtoMethods = Array.prototype;\n\n// 继承一下 arrayMethods.__proto__ = oldArrayProtoMethods;\nexport let arrayMethods = Object.create(oldArrayProtoMethods);\n\n\nlet methods = [\n   'push',\n   'pop',\n   'shift',\n   'unshift',\n   'sort',\n   'reverse',\n   'splice'\n]\n// 在它上面进行方法的扩展\nmethods.forEach(method => {\n   arrayMethods[method] = function (...args) {\n      // \n      console.log('数组方法调用了');\n      let result = oldArrayProtoMethods[method].apply(this, args);\n   }\n})\n","import {arrayMethods} from './array'\nclass Observer {\n  constructor(value) {\n    // 使用defineProperty重新定义\n    // console.log(value)\n     if (Array.isArray(value)) {\n       // 使用AOP切片进行方法重写。\n        value.__proto__ = arrayMethods\n\n        // 观测数组中的对象变化\n        this.observeArray(value);\n    } else {\n      this.walk(value);\n    }\n  }\n   \n   observeArray(value) {\n      value.forEach(item => {\n         observe(item);// 观测数组的对象。\n      })\n   }\n   \n   \n  walk(data) {\n    let keys = Object.keys(data); // 获取对象的key\n    keys.forEach((key) => {\n      defineReactive(data, key, data[key]);\n    });\n  }\n}\nfunction defineReactive(data, key, value) {\n  observe(value);\n  Object.defineProperty(data, key, {\n    get() {\n      return value;\n    },\n    set(newVal) {\n      if (newVal == value) return;\n      observe(newVal); // 如果用户将值改成对象，递归设置。\n      value = newVal;\n    },\n  });\n}\nexport function observe(data) {\n  // console.log(data);\n  if (data == null || typeof data !== \"object\") {\n    return;\n  }\n  return new Observer(data);\n}\n","import { observe } from \"./observer/index\";\nexport function initState(vm) {\n  // vm.$options\n  // console.log(vm)\n  const options = vm.$options;\n\n  // 初始化数据的过程。\n  if (options.props) {\n    initProps(vm);\n  }\n  if (options.methods) {\n    initMethods(vm);\n  }\n  if (options.data) {\n    initData(vm);\n  }\n  if (options.computed) {\n    initComputed(vm);\n  }\n  if (options.watch) {\n    initWatch(vm);\n  }\n}\nfunction initProps() {}\nfunction initMethods() {}\nfunction initData(vm) {\n  // 数据的初始化---这里的数据可能是函数，也可能是属性。\n  let data = vm.$options.data;\n   //  console.log('---', data);\n  // 如果是函数，this指向 vm\n  /*\n   data() {\n      this  ---这里指向的就是vm当前实例。\n      return {\n      \n      }\n   }\n   */\n  // 将数据防止当vm上面，让vm可以拿到data\n\n  vm._data = data = typeof data === \"function\" ? data.call(vm) : data;\n\n  // 数据的劫持方案---对象Object.defineProperty; 数组--单独处理\n  observe(data);\n}\nfunction initComputed() {}\nfunction initWatch() {}\n","import { initState } from \"./state\";\nexport function initMixin(Vue) {\n  // 初始化方法。---\n  Vue.prototype._init = function (options) {\n    // console.log(options);\n    // 吧options放到实例上去\n    const vm = this;\n    vm.$options = options;\n\n    // vue里面的核心特性-- 响应式数据原理。\n\n    // 初始化状态---将数据进行一个初始化的劫持。当我们改变数据的时候应该更新视图。\n    // vue组件中有很多状态--data props watch computed\n    initState(vm);\n  };\n}\n","// export  const fn = () => {\n// }\n// 使用构造函数来实现\n/*\noptions写法的就是将new Vue({\n   el:'#app',\n   data(){\n   return {\n     a:1\n   }\n   },\n   watch:{} 得的各类参数传递给了 Vue这个构造函数的options中。\n})\n*/\nimport { initMixin } from \"./init\";\nfunction Vue(options) {\n  //   console.log(options)\n  this._init(options); // 入口方法，做初始化操作\n}\n// 写成一个个的插件，对原型进行扩展。\ninitMixin(Vue);\n\nexport default Vue;\n"],"names":["oldArrayProtoMethods","Array","prototype","arrayMethods","Object","create","methods","forEach","method","args","console","log","result","apply","Observer","constructor","value","isArray","__proto__","observeArray","walk","item","observe","data","keys","key","defineReactive","defineProperty","get","set","newVal","initState","vm","options","$options","props","initData","computed","watch","_data","call","initMixin","Vue","_init"],"mappings":"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"}